<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QCM : Géologie</title>
    <link rel="stylesheet" href="../css/styleqcm1.css">
</head>
<body>

<div class="nav-buttons">
    <a href="fiche01.html"   class="nav-button"  >Retour</a>
    <a href="" class="nav-button"  disabled>Page précédente</a>
    <a href="" class="nav-button"  disabled>Page suivante</a>
</div>

<div class="container">
    <h1>QCM : Géologie - Auto-évaluation</h1>
    <h2>Isostasie et Structure Terrestre</h2>
    <form id="qcm-form">
        <div class="question-box" id="q3-box">
            <div class="question">1. Dans quelle couche terrestre se produit principalement l'isostasie ?</div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q3" value="B"> A) Le noyau externe </label>
                <label><input type="radio" class="checkbox-margin" name="q3" value="D"> B) Le noyau interne </label>
                <label><input type="radio" class="checkbox-margin" name="q3" value="A"> C) La croûte terrestre </label>
                <label><input type="radio" class="checkbox-margin" name="q3" value="C"> D) Le manteau supérieur </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
			<div class='comment' style='display:none;'><strong>Commentaire:</strong> La principale couche terrestre où se produit l'isostasie est la croûte terrestre. C'est dans cette couche, qui est relativement rigide et flottante par rapport à l'asthénosphère sous-jacente, que les ajustements isostatiques se manifestent. Lorsque des masses de roche, telles que des montagnes ou des glaciers, sont retirées ou ajoutées, la croûte terrestre se déplace verticalement pour retrouver un équilibre, réagissant à la perte ou au gain de charge. Ce phénomène est essentiel pour comprendre les changements de relief et la dynamique de la lithosphère.</div>
		</div>
        <div class="question-box" id="q4-box">
            <div class="question">2. Quel instrument est souvent utilisé pour détecter les déséquilibres isostatiques dans la croûte terrestre ?</div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q4" value="C"> A) Baromètre </label>
                <label><input type="radio" class="checkbox-margin" name="q4" value="A"> B) Sismographe </label>
                <label><input type="radio" class="checkbox-margin" name="q4" value="B"> C) Gravimètre </label>
                <label><input type="radio" class="checkbox-margin" name="q4" value="D"> D) Anémomètre </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
			<div class='comment' style='display:none;'><strong>Commentaire:</strong> L'instrument souvent utilisé pour détecter les déséquilibres isostatiques dans la croûte terrestre est le <strong>gravimètre</strong>. Cet appareil permet de mesurer les variations de la gravité à la surface de la Terre, ce qui révèle des différences de densité sous la surface. Ces données sont précieuses pour identifier des déséquilibres isostatiques, qui sont invisibles en observant simplement la topographie. Le gravimètre aide ainsi à comprendre la répartition des masses et les ajustements isostatiques dans la croûte terrestre.</div>
		</div>
        <div class="question-box" id="q5-box">
            <div class="question">3. Comment se traduit le phénomène de subsidence dans une zone côtière ?</div>
			<div class='options'>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="D"> A) Une augmentation de la densité de la croûte </label>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="C"> B) Un enfoncement progressif du sol </label>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="E"> C) Un approfondissement du milieu marin </label>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="B"> D) Une baisse du niveau de la mer </label>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="A"> E) Une élévation du sol </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
			<div class='comment' style='display:none;'><strong>Commentaire:</strong> Le phénomène de subsidence dans une zone côtière se traduit par un <strong>enfoncement progressif du sol</strong>. </div>
		</div>
        <div class="question-box" id="q1-box">
            <div class="question">4. Quelle est la principale cause de l'isostasie ?</div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q1" value="C"> A) Le climat </label>
                <label><input type="radio" class="checkbox-margin" name="q1" value="A"> B) La tectonique des plaques </label>
                <label><input type="radio" class="checkbox-margin" name="q1" value="B"> C) La densité de la croûte terrestre </label>
                <label><input type="radio" class="checkbox-margin" name="q1" value="D"> D) La pression atmosphérique </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
			<div class='comment' style='display:none;'><strong>Commentaire:</strong> La principale cause de l'isostasie est la différence de densité entre la croûte terrestre (plus légère) et le manteau (plus lourd), qui fait que la croûte "flotte" sur le manteau en équilibre gravitationnel. Notez que d'autres facteurs comme l'épaisseur ou des variations de masse peuvent influencer cet équilibre isostatique.</div>
		</div>
        <div class="question-box" id="q2-box">
            <div class="question">5. Quel est l'effet de l'érosion sur l'isostasie ?</div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q2" value="B"> A) Elle diminue la densité de la croûte </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="C"> B) Elle déclenche un relèvement isostatique </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="A"> C) Elle augmente la masse de la croûte </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="D"> D) Elle provoque une subsidence </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
			<div class='comment' style='display:none;'><strong>Commentaire:</strong> L'érosion exerce une influence notable sur l'isostasie en provoquant une diminution de la charge sur la croûte terrestre. En réponse à cette réduction, la croûte tend à se soulever pour retrouver un nouvel équilibre isostatique. Ce phénomène est bien plus complexe qu'il n'y paraît à première vue ; il ne se limite pas à de simples variations d'altitude, mais implique également des processus dynamiques à long terme qui modifient la topographie et la structure géologique de la région. Ainsi, l'impact de l'érosion sur l'isostasie dépasse largement ce que l'on pourrait évaluer uniquement par des mesures altimétriques.</div>
		</div>

        <div class="buttons">
            <button type="button" onclick="evaluateQCM()">Corriger</button>
            <button type="button" onclick="resetTest()">Recommencer</button>
        </div>

    </form>
    <p id="result"></p>
</div>

<footer>
    GeoCool - @ <script> document.write(new Date().getFullYear())</script> - Régis THIÉRY
</footer>

<script>
    function evaluateQCM() {
        const correctAnswers = {
            "q3": ["A"],
            "q4": ["B"],
            "q5": ["C", "E"],
            "q1": ["B"],
            "q2": ["C"],
        };
        

        let score = 0;

        function generateFeedbackText(goodAnswers, goodCount, questionBox) {
            // Fonction utilitaire pour récupérer les 3 premières lettres d'une réponse
    
            function getAnswerLabel(value) {
                const label = questionBox.querySelector(`input[value="${value}"]`).parentNode;
                return label.textContent.trim().slice(0, 3); // Extrait les 3 premières lettres (ex: "A)")
            }

            if (goodAnswers.length === 0) {
                return "Pas de bonne réponse !";
            }

            const formattedAnswers = goodAnswers.map(answer => getAnswerLabel(answer));

            if (goodAnswers.length === 1) {
                return `${formattedAnswers[0]} est ${goodCount === 1 ? "la" : "une"} bonne réponse.`;
            }

            if (goodAnswers.length > 1) {
                return `${formattedAnswers.slice(0, -1).join(", ")} et ${formattedAnswers[formattedAnswers.length - 1]} sont de bonnes réponses.`;
            }

            return "";
            }


        for (let question in correctAnswers) {
            const selected = Array.from(document.querySelectorAll(`input[name="${question}"]:checked`)).map(e => e.value);
            const questionBox = document.getElementById(`${question}-box`);
            const correctOptions = correctAnswers[question];
            
            const goodAnswers = selected.filter(val => correctOptions.includes(val));
            let feedback = generateFeedbackText(goodAnswers, correctOptions.length, questionBox);

            let isCorrect = selected.length === correctOptions.length && correctOptions.every(option => selected.includes(option));
            questionBox.classList.toggle("correct", isCorrect);
            questionBox.classList.toggle("incorrect", !isCorrect);

            selected.forEach(val => {
                const optionLabel = questionBox.querySelector(`input[value="${val}"]`).parentNode;
                if (correctOptions.includes(val)) {
                    optionLabel.style.fontWeight = "bold";
                } else {
                    optionLabel.classList.add("strikethrough");
                }
            });

            correctOptions.forEach(val => {
                const correctOptionLabel = questionBox.querySelector(`input[value="${val}"]`).parentNode;
                if (!selected.includes(val)) {
                    correctOptionLabel.style.fontWeight = "bold";
                }
            });

            const correctAnswerLabel = questionBox.querySelector('.correct-answer');
            const feedbackLabel = questionBox.querySelector('.feedback');
            const commentBox = questionBox.querySelector('.comment');
            if (feedbackLabel) {
                feedbackLabel.style.display = 'block';
                feedbackLabel.innerHTML = feedback;
            }
            if (commentBox) {
                commentBox.style.display = 'block';
            }
           
            // Mappage des bonnes réponses avec les lettres (A, B, C, D)
            const correctAnswerLabels = correctOptions.map(val => {
                const label = questionBox.querySelector(`input[value="${val}"]`).parentNode;
                const text = label.textContent.trim();
                return `${text}`;
                });


            let correctAnswerText = correctOptions.length === 1 
                ? `Bonne réponse : ${correctAnswerLabels.join("; ")}`
                : `Bonnes réponses : ${correctAnswerLabels.join("; ")}`;
            
            correctAnswerLabel.innerHTML = correctAnswerText;
            correctAnswerLabel.style.display = 'block';

            if (isCorrect) score+=goodAnswers.length;
        }

        const totalValues = Object.values(correctAnswers).reduce((acc, curr) => acc + curr.length, 0);
        const result = document.getElementById("result");

        if (score === 0) {
            result.textContent = `Vous n'avez obtenu aucune bonne réponse sur ${totalValues}.`;
        } else if (score === 1) {
            result.textContent = `Vous avez obtenu 1 bonne réponse sur ${totalValues}.`;
        } else {
            result.textContent = `Vous avez obtenu ${score} bonnes réponses sur ${totalValues}.`;
        }
    }

    function resetTest() {
        window.location.reload();
    }

    function openModal(imgElement) {
        var modal = document.getElementById("imageModal");
        var modalImg = document.getElementById("modalImage");
        modal.style.display = "block";
        modalImg.src = imgElement.src;  // Utiliser l'image cliquée
    }

    function closeModal() {
        var modal = document.getElementById("imageModal");
        modal.style.display = "none";
    }

</script>




</body>
</html>
