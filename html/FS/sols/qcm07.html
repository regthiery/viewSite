<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QCM : QCM Sols</title>
    <link rel="stylesheet" href="../../css/styleqcm1.css">
</head>
<body>

    <nav>
        <ul>
            <li><a href="../../index.html">Accueil</a></li>
            <li><a href="../../index0.html">Cours</a></li>
            <li><a href="../../videos.html">Videos</a></li>
            <li><a href="../../apropos.html">À propos</a></li>
        </ul>
    </nav>


<div class="nav-buttons">
    <a href="../fiche03.html"   class="nav-button"  >Retour</a>
    <a href="qcm06.html" class="nav-button"  >QCM précédent</a>
    <a href="" class="nav-button"  disabled>QCM suivant</a>
</div>

<div class="container">
    <h1>QCM : Les sols - Auto-évaluation</h1>
    <h2>À l'interface entre lithosphère, atmosphère, hydrosphère et biosphère ?</h2>
    <form id="qcm-form">
        <div class="question-box" id="q1-box">
            <div class="question">1. Qu'est-ce que la chorologie ? </div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q1" value="B"> A) C'est une discipline scientifique développée par le Professeur Choron. </label>
                <label><input type="radio" class="checkbox-margin" name="q1" value="C"> B) C'est l'étude des danses nuptiales des animaux. </label>
                <label><input type="radio" class="checkbox-margin" name="q1" value="D"> C) C'est l'étude de la géographie du monde, région par région. </label>
                <label><input type="radio" class="checkbox-margin" name="q1" value="A"> D) C'est l'étude de la répartition géographiques des espèces vivantes et de ses causes. </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
		</div>
        <div class="question-box" id="q2-box">
            <div class="question">2. La figure ci-dessous présente une représentation simplifiée des facteurs de la pédogénèse pour les sols du Référentiel Pédologique. Quels sont les sols qui peuvent se former sous n'importe quel climat et qui sont caractérisés par une humidité forte ?</div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q2" value="C"> A) Les cryosols. </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="E"> B) Les ferrallitisols. </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="F"> C) Les podzosols et chernosols. </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="D"> D) Les brunisols et luvisols. </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="B"> E) Les calcisols, les calcosols, les salisols, les lithosols et sodisols. </label>
                <label><input type="radio" class="checkbox-margin" name="q2" value="A"> F) Les réductisols et les rédoxysols. </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
		</div>
        <div class="question-box" id="q3-box">
            <div class="question">3. Dans quel sol du Référentiel pédologique trouve-t-on les teneurs les plus importantes en carbonates ? </div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q3" value="D"> A) Les chernosols. </label>
                <label><input type="radio" class="checkbox-margin" name="q3" value="C"> B) Les vertisols. </label>
                <label><input type="radio" class="checkbox-margin" name="q3" value="A"> C) Les calcosols. </label>
                <label><input type="radio" class="checkbox-margin" name="q3" value="B"> D) Les calcisols. </label>
                <label><input type="radio" class="checkbox-margin" name="q3" value="E"> E) Les luvisols. </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
		</div>
        <div class="question-box" id="q4-box">
            <div class="question">4. Dans quel sol du Référentiel pédologique trouve-t-on les teneurs les plus importantes en sodium ? </div>
			<div class='options'>
                <label><input type="radio" class="checkbox-margin" name="q4" value="E"> A) Les calcosols. </label>
                <label><input type="radio" class="checkbox-margin" name="q4" value="C"> B) Les vertisols. </label>
                <label><input type="radio" class="checkbox-margin" name="q4" value="B"> C) Les calcisols. </label>
                <label><input type="radio" class="checkbox-margin" name="q4" value="D"> D) Les chernosols. </label>
                <label><input type="radio" class="checkbox-margin" name="q4" value="A"> E) Les sodisols. </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
		</div>
        <div class="question-box" id="q5-box">
            <div class="question">5. Qu'est-ce qui différencie les sols des pays chauds de ceux des pays froids du point de vue de l'altération chimique ? </div>
			<div class='options'>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="A"> A) Dans les pays chauds, l'altération chimique appauvrit les sols en silice, alcalins et alcalino-terreux. </label>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="D"> B) Dans les pays chauds, l'altération chimique enrichit les sols en silice, alcalins et alcalino-terreux. </label>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="B"> C) Dans les pays froids, l'altération chimique appauvrit la partie supérieure des sols en aluminium et Fe<sup>3+</sup>. </label>
                <label><input type="checkbox" class="checkbox-margin" name="q5" value="C"> D) Dans les pays chauds, l'altération chimique enrichit la partie supérieure des sols en aluminium et Fe<sup>3+</sup>. </label>
			</div>
			<p class='feedback' style='display:none;'></p>
			<p class='correct-answer' style='display:none;'></p>
		</div>

        <div class="buttons">
            <button type="button" onclick="evaluateQCM()">Corriger</button>
            <button type="button" onclick="resetTest()">Recommencer</button>
        </div>

    </form>
    <p id="result"></p>
</div>

<footer>
    GeoCool - @ <script> document.write(new Date().getFullYear())</script> - Régis THIÉRY
</footer>

<script>
    function evaluateQCM() {
        const correctAnswers = {
            "q1": ["A"],
            "q2": ["A"],
            "q3": ["A"],
            "q4": ["A"],
            "q5": ["A", "B", "C"],
        };
        

        let score = 0;

        function generateFeedbackText(goodAnswers, goodCount, questionBox) {
            // Fonction utilitaire pour récupérer les 3 premières lettres d'une réponse
    
            function getAnswerLabel(value) {
                const label = questionBox.querySelector(`input[value="${value}"]`).parentNode;
                return label.textContent.trim().slice(0, 3); // Extrait les 3 premières lettres (ex: "A)")
            }

            if (goodAnswers.length === 0) {
                return "Pas de bonne réponse !";
            }

            const formattedAnswers = goodAnswers.map(answer => getAnswerLabel(answer));

            if (goodAnswers.length === 1) {
                return `${formattedAnswers[0]} est ${goodCount === 1 ? "la" : "une"} bonne réponse.`;
            }

            if (goodAnswers.length > 1) {
                return `${formattedAnswers.slice(0, -1).join(", ")} et ${formattedAnswers[formattedAnswers.length - 1]} sont de bonnes réponses.`;
            }

            return "";
            }


        for (let question in correctAnswers) {
            const selected = Array.from(document.querySelectorAll(`input[name="${question}"]:checked`)).map(e => e.value);
            const questionBox = document.getElementById(`${question}-box`);
            const correctOptions = correctAnswers[question];
            
            const goodAnswers = selected.filter(val => correctOptions.includes(val));
            let feedback = generateFeedbackText(goodAnswers, correctOptions.length, questionBox);

            let isCorrect = selected.length === correctOptions.length && correctOptions.every(option => selected.includes(option));
            questionBox.classList.toggle("correct", isCorrect);
            questionBox.classList.toggle("incorrect", !isCorrect);

            selected.forEach(val => {
                const optionLabel = questionBox.querySelector(`input[value="${val}"]`).parentNode;
                if (correctOptions.includes(val)) {
                    optionLabel.style.fontWeight = "bold";
                } else {
                    optionLabel.classList.add("strikethrough");
                }
            });

            correctOptions.forEach(val => {
                const correctOptionLabel = questionBox.querySelector(`input[value="${val}"]`).parentNode;
                if (!selected.includes(val)) {
                    correctOptionLabel.style.fontWeight = "bold";
                }
            });

            const correctAnswerLabel = questionBox.querySelector('.correct-answer');
            const feedbackLabel = questionBox.querySelector('.feedback');
            const commentBox = questionBox.querySelector('.comment');
            if (feedbackLabel) {
                feedbackLabel.style.display = 'block';
                feedbackLabel.innerHTML = feedback;
            }
            if (commentBox) {
                commentBox.style.display = 'block';
            }
           
            // Mappage des bonnes réponses avec les lettres (A, B, C, D)
            const correctAnswerLabels = correctOptions.map(val => {
                const label = questionBox.querySelector(`input[value="${val}"]`).parentNode;
                const text = label.textContent.trim();
                return `${text}`;
                });


            let correctAnswerText = correctOptions.length === 1 
                ? `Bonne réponse : ${correctAnswerLabels.join("; ")}`
                : `Bonnes réponses : ${correctAnswerLabels.join("; ")}`;
            
            correctAnswerLabel.innerHTML = correctAnswerText;
            correctAnswerLabel.style.display = 'block';

            if (isCorrect) score+=goodAnswers.length;
        }

        const totalValues = Object.values(correctAnswers).reduce((acc, curr) => acc + curr.length, 0);
        const result = document.getElementById("result");

        if (score === 0) {
            result.textContent = `Vous n'avez obtenu aucune bonne réponse sur ${totalValues}.`;
        } else if (score === 1) {
            result.textContent = `Vous avez obtenu 1 bonne réponse sur ${totalValues}.`;
        } else {
            result.textContent = `Vous avez obtenu ${score} bonnes réponses sur ${totalValues}.`;
        }
    }

    function resetTest() {
        window.location.reload();
    }

    function openModal(imgElement) {
        var modal = document.getElementById("imageModal");
        var modalImg = document.getElementById("modalImage");
        modal.style.display = "block";
        modalImg.src = imgElement.src;  // Utiliser l'image cliquée
    }

    function closeModal() {
        var modal = document.getElementById("imageModal");
        modal.style.display = "none";
    }

</script>




</body>
</html>
